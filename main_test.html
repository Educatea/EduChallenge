<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educatea Mobile</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/theme.css" rel="stylesheet">
    <link href="css/bootstrap-reset.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/flexslider.css"/>
    <link href="assets/bxslider/jquery.bxslider.css" rel="stylesheet" />
    <link href="assets/fancybox/source/jquery.fancybox.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/revolution_slider/css/rs-style.css" media="screen">
    <link rel="stylesheet" href="assets/revolution_slider/rs-plugin/css/settings.css" media="screen">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/style-responsive.css" rel="stylesheet" />
</head>

<body>
    <div class="container" style="width: 100%">

        <div id="userInfo">

<section class="panel">
                          <header class="panel-heading" align="center" style="font-weight:bold;">
                              Top 5 Ránking
                          </header>

                          <section class="panel" id="friends_rank">

                      </section>
                      
                      </section>
        <div class="row state-overview">
                  <div class="col-lg-3 col-sm-6">
                      <section class="panel">
                          <div class="symbol terques">
                              <i class="fa fa-user"></i>
                          </div>
                          <div class="value">
                              <h1 class="count" id="rankingValue" style="font-weight: bold; color: #74829C;"></h1>
                              <p style="font-weight: bold; color: #74829C;">Ránking</p>
                          </div>
                      </section>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                      <section class="panel">
                          <div class="symbol red">
                              <i class="fa fa-star"></i>
                          </div>
                          <div class="value">
                              <h1 style="font-weight: bold; color: #74829C;" class=" count2" id="weeklyVal"></h1>
                              <p style="font-weight: bold; color: #74829C;">Puntaje semanal</p>
                          </div>
                      </section>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                      <section class="panel">
                          <div class="symbol yellow">
                              <i class="fa fa-trophy"></i>
                          </div>
                          <div class="value">
                              <h1 class=" count3" style="font-weight: bold; color: #74829C;" id="championshipVal"></h1>
                              <p style="font-weight: bold; color: #74829C;">Semanas victoriosas</p>
                          </div>
                      </section>
                  </div>
                  <div class="col-lg-3 col-sm-6">
                      <section class="panel">
                          <div class="symbol blue">
                              <i class="fa fa-bar-chart-o"></i>
                          </div>
                          <div class="value">
                              <h1 class=" count4" style="font-weight: bold; color: #74829C;" id="historicVal"></h1>
                              <p style="font-weight: bold; color: #74829C;">Puntaje histórico</p>
                          </div>
                      </section>
                  </div>
              </div>
        <br>
        <br>
        <br>

                <a class="btn btn-danger btn-block btn-lg" style="margin-bottom:8%;" href="solve_test.html"><i class="fa fa-pencil"></i>  Jugar</a>


        <p align="center" style="color: #000000;">Si cierra sesión deberá volver a ingresar sus credenciales</p>
        <button class="btn btn-block">Salir</button>
        <hr/>

    </div>
     </div>
    <footer class="site-footer" style="z-index: 1000; bottom:0px; position:fixed; width:100%;">
      <div class="text-center">
        2015 © Desarrollado por Educatea
      </div>
    </footer>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-migrate-1.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/hover-dropdown.js"></script>
    <script defer src="js/jquery.flexslider.js"></script>
    <script type="text/javascript" src="assets/bxslider/jquery.bxslider.js"></script>
    <script type="text/javascript" src="js/jquery.parallax-1.1.3.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/link-hover.js"></script>
    <script src="assets/fancybox/source/jquery.fancybox.pack.js"></script>
    <script type="text/javascript" src="assets/revolution_slider/rs-plugin/js/jquery.themepunch.plugins.min.js"></script>
    <script type="text/javascript" src="assets/revolution_slider/rs-plugin/js/jquery.themepunch.revolution.min.js"></script>
    <script src="js/loading.js"></script>
    <script src="js/common-scripts.js"></script>
    <script src="js/revulation-slide.js"></script>
    <script>
        $(document).ready(function(){
            img = {'square': 'http://graph.facebook.com/10152763176677496/picture?type=square', 'small': 'http://graph.facebook.com/10152763176677496/picture?type=small', 'normal': 'http://graph.facebook.com/10152763176677496/picture?type=normal', 'large': 'http://graph.facebook.com/10152763176677496picture?type=large'};
            
            current_user = { 'id': '10152763176677496','token': 'CAALbheeb6zoBALYFM7pm0SzvmOEhlcxZCJ8CI7SsBd0HuU8VcmCiE01SlergCDou6k5OGIgVGyp9TZAZBfNpsnul8fMtIV4ZBzpw8ZBp0UTN2EytVzUs6LrSIeznwtgZB9PIHbsRRw3K0ieGx4CALQjQVUq8TirnL07TetBYSwMSVsfIjbPda8Qw7KnsT8gDWJMGgXEFmZBMdYqGCILBEme3iU01oxeRCgZD', 'name': 'Juan Gesino', 'img': img };

            localStorage['current_user'] = JSON.stringify(current_user);

            $.blockUI({ css: {
                border: 'none',
                padding: '15px',
                backgroundColor: '#000',
                '-webkit-border-radius': '10px',
                '-moz-border-radius': '10px',
                opacity: .5,
                color: '#fff'
            } });
            
                current_user = JSON.parse(localStorage['current_user']);
                html ='<div class="row" style="margin-top:5%;"><div class="col-lg-12"><section class="panel"><div class="twt-feed blue-bg"><h1>'+current_user.name+'</h1><p></p><a href="#"><img src="' +current_user.img.normal+'" alt=""></a></div><div class="weather-category twt-category"><h3 style="text-align:center;"><span id="leftEx" style="font-weight:bold; font-size:40px;"></span> <br>Ejercicios restantes para hoy</h3></div></section></div></div>';
                $(html).prependTo('#userInfo');
                $('#userToken').append(current_user.token);
                $('#userId').append(current_user.id);

                var url = "http://localhost:3000/api/v1/challenge/";
                $.ajax({
                    type: "GET",
                    url: url,
                    success: function(data){
                        $('#leftEx').text(10-data.user.daily_counter);
                        $('#weeklyVal').text(data.user.weekly_counter);
                        $('#championshipVal').text(data.user.championship_counter);
                        $('#historicVal').text(data.user.historic_points);
                        if(data.user.daily_counter == 10){
                            $('#play').remove();
                        }

                        rank = 1;
                        html = '';
                        $.each(data.user.get_friends_rank, function(key, val){

                          if(rank == 1){
                            trophy = '<h3 style="margin-top:-25px; font-size:45px; color: #BEA20B;"><i class="fa fa-trophy"></i></h3>';
                          }else{
                            trophy = '';
                          }

                          if (val.uid == JSON.parse(localStorage['current_user']).id) {
                            background = 'style="background-color: #FDEEB4;"';
                            my_rank = rank;
                          }else{
                            background = '';
                          }

                          html = html + '<div class="panel-body" '+background+'><div class="fb-user-thumb"><img src="http://graph.facebook.com/' + val.uid + '/picture?type=small" alt="">'+trophy+'</div><div class="fb-user-details"><h3><a href="#" class="#">'+val.name+'</a></h3><p style="font-weight: bold; color: #74829C;">'+val.weekly_counter+' Respuestas correctas esta semana</p></div><div class="clearfix"></div></div>';

                          rank++;
                        });

                        $('#friends_rank').append(html);

                        $('#rankingValue').text(my_rank);
                        
                        done();
                    },
                    error: error,
                    timeout: timeout,
                    headers: {
                        "Authorization": "Basic " + btoa(JSON.parse(localStorage['current_user']).id + ":" + JSON.parse(localStorage['current_user']).token)
                    }
                });

            
        });
    </script>

</body>
</html>
